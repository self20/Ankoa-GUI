#:kivy 1.8.0
#:import x_x app.mod_remux.remux_dict.x_x

# ---------- VIDEO SETTINGS POPUP ----------
<VideoSettingsPopup>:
    size_hint: .5, .6
    auto_dismiss: True
    title: 'Video Settings'

    GridLayout:
        cols: 1
        spacing: 5
        row_force_default: True
        row_default_height: 50

        # --- VIDEO FLAG ---
        BoxLayout:
            padding: 8
            canvas:
                Color:
                    rgba: 47 / 255., 167 / 255., 212 / 255., .1
                Rectangle:
                    size: self.size
                    pos: self.pos

            Switch:
                id: check_flag
                size_hint_x: .2
                touch_control: False
                active:
                    True if\
                    root.ids.default_track.state == 'down' or\
                    root.ids.forced_track.state == 'down' else False

            Label:
                text: 'Video flag'
                size_hint_x: .4

            ToggleButton:
                id: default_track
                size_hint_x: .3
                text: 'DEFAULT'

            ToggleButton:
                id: forced_track
                size_hint_x: .3
                text: 'FORCED'

        # --- ASPECT RATIO ---
        BoxLayout:
            padding: 8
            canvas:
                Color:
                    rgba: 47 / 255., 167 / 255., 212 / 255., .2
                Rectangle:
                    size: self.size
                    pos: self.pos

            Switch:
                size_hint_x: .2
                id: check_ar
                touch_control: False
                active:
                    True if root.ids.check_reso.active is False and\
                    root.ids.video_ar.text != '' else False

            Label:
                text: 'Aspect ratio'
                size_hint_x: .4

            Slider:
                size_hint_x: .35
                id: aspect
                min: 0
                max: 8
                step: 1
                value: 0
            Label:
                size_hint_x: .05

            TextInput:
                id: video_ar
                size_hint_x: .18
                padding: 8, 8, 0, 0
                hint_text: 'Custom'
                text:
                    x_x['aspect_ratio'][int('{}'.format(
                    aspect.value).split('.')[0])]

        # --- RESOLUTION ---
        BoxLayout:
            padding: 8
            canvas:
                Color:
                    rgba: 47 / 255., 167 / 255., 212 / 255., .1
                Rectangle:
                    size: self.size
                    pos: self.pos

            Switch:
                size_hint_x: .2
                id: check_reso
                touch_control: False
                active:
                    True if root.ids.check_ar.active is False and\
                    root.ids.video_width.text != '' and\
                    root.ids.video_height.text != '' else False

            Label:
                text: 'Resolution'
                size_hint_x: .4

            TextInput:
                id: video_width
                size_hint_x: .3
                hint_text: 'Width'
                input_filter: 'int'
                padding: 8, 8, 0, 0

            TextInput:
                id: video_height
                size_hint_x: .3
                hint_text: 'Height'
                input_filter: 'int'
                padding: 8, 8, 0, 0

        # --- MANUAL CROP ---
        BoxLayout:
            padding: 8
            canvas:
                Color:
                    rgba: 47 / 255., 167 / 255., 212 / 255., .2
                Rectangle:
                    size: self.size
                    pos: self.pos

            Switch:
                size_hint_x: .2
                id: check_crop
                touch_control: False
                active:
                    True if root.ids.crop_left.text != '' and\
                    root.ids.crop_top.text != '' and\
                    root.ids.crop_right.text != '' and\
                    root.ids.crop_bottom.text != '' else False

            Label:
                text: 'Custom crop'
                size_hint_x: .4

            TextInput:
                id: crop_left
                size_hint_x: .15
                hint_text: 'Left'
                input_filter: 'int'
                padding: 6, 8, 0, 0

            TextInput:
                id: crop_top
                size_hint_x: .15
                hint_text: 'Top'
                input_filter: 'int'
                padding: 6, 8, 0, 0

            TextInput:
                id: crop_right
                size_hint_x: .15
                hint_text: 'Right'
                input_filter: 'int'
                padding: 6, 8, 0, 0

            TextInput:
                id: crop_bottom
                size_hint_x: .15
                hint_text: 'Bottom'
                input_filter: 'int'
                padding: 4, 8, 0, 0

        # --- FRAMERATE ---
        BoxLayout:
            padding: 8
            canvas:
                Color:
                    rgba: 47 / 255., 167 / 255., 212 / 255., .1
                Rectangle:
                    size: self.size
                    pos: self.pos

            Switch:
                size_hint_x: .2
                id: check_framerate
                touch_control: False
                active:
                    True if root.ids.framerate.text != '' else False

            Label:
                text: 'Framerate'
                size_hint_x: .4

            Slider:
                size_hint_x: .3
                id: _framerate
                min: 0
                max: 11
                step: 1
                value: 0
            Label:
                size_hint_x: .05

            TextInput:
                id: framerate
                size_hint_x: .25
                padding: 8, 8, 0, 0
                hint_text: 'Custom'
                text:
                    x_x['framerate'][int('{}'.format(
                    _framerate.value).split('.')[0])]

        # --- VIDEO DELAY ---
        BoxLayout:
            padding: 8
            canvas:
                Color:
                    rgba: 47 / 255., 167 / 255., 212 / 255., .2
                Rectangle:
                    size: self.size
                    pos: self.pos

            Switch:
                size_hint_x: .2
                id: check_delay
                touch_control: False
                active:
                    True if\
                    root.ids.video_delay.text != '' or\
                    root.ids.video_strech.text != '' else False

            Label:
                text: 'Video delay'
                size_hint_x: .4

            TextInput:
                id: video_delay
                size_hint_x: .25
                hint_text: 'Delay (ms)'
                padding: 8, 8, 0, 0

            TextInput:
                id: video_strech
                size_hint_x: .35
                hint_text: 'Strech by'
                padding: 8, 8, 0, 0

        # --- COMPRESSION ---
        BoxLayout:
            padding: 8
            canvas:
                Color:
                    rgba: 47 / 255., 167 / 255., 212 / 255., .1
                Rectangle:
                    size: self.size
                    pos: self.pos

            Switch:
                size_hint_x: .2
                id: check_compression
                touch_control: False
                active:
                    True if\
                    root.ids.compress_none.state == 'down' or\
                    root.ids.compress_zlib.state == 'down' else False

            Label:
                text: 'Compression'
                size_hint_x: .4

            ToggleButton:
                id: compress_none
                size_hint_x: .3
                text: 'NONE'

            ToggleButton:
                id: compress_zlib
                size_hint_x: .3
                text: 'ZLiB'
