#:kivy 1.8.0

<SettingsPopup>:
    size_hint: .8, .8
    auto_dismiss: False
    title: 'Settings'
    GridLayout:
        cols: 1
        rows: 10
        spacing: 5
        row_force_default: True
        row_default_height: 50

        # ---------- USAGE ----------
        BoxLayout:
            ToggleButton:
                id: local_usage
                text: 'LOCAL USAGE'
                group: 'usage'
                bold: True
            ToggleButton:
                id: remote_usage
                text: 'REMOTE USAGE'
                state:
                    'down' if root.ids.remote.active == True and\
                    root.ids.local_folder.active == True else 'normal'
                group: 'usage'
                bold: True

        # ---------- SOURCE FOLDER ----------
        BoxLayout:
            padding: '8sp'
            canvas:
                Color:
                    rgba: .2, .3, .4, .5
                Rectangle:
                    size: self.size
                    pos: self.pos
            Switch:
                id: S_folder
                size_hint_x: .20
                touch_control: False
                active:
                    True if root.ids.source_folder.text else False
            Label:
                text: 'Source'
                size_hint_x: .40
            TextInput:
                hint_text: 'ex: /home/user/SOURCES/'
                text: app.source_folder
                readonly:
                    False if root.ids.remote_usage.state == 'down' or\
                    root.ids.local_usage.state == 'down' else True
                id: source_folder

        # ---------- DESTINATION FOLDER ----------
        BoxLayout:
            padding: '8sp'
            canvas:
                Color:
                    rgba: .2, .3, .4, 1
                Rectangle:
                    size: self.size
                    pos: self.pos
            Switch:
                id: D_folder
                size_hint_x: .20
                touch_control: False
                active:
                    True if root.ids.dest_folder.text else False
            Label:
                text: 'Destination'
                size_hint_x: .40
            TextInput:
                hint_text: 'ex: /home/user/ENCODES/'
                text: app.dest_folder
                readonly:
                    False if root.ids.remote_usage.state == 'down' or\
                    root.ids.local_usage.state == 'down' else True
                id: dest_folder

        # ---------- TEAM NAME ----------
        BoxLayout:
            padding: '8sp'
            canvas:
                Color:
                    rgba: .2, .3, .4, .5
                Rectangle:
                    size: self.size
                    pos: self.pos
            Switch:
                id: team
                size_hint_x: .20
                touch_control: False
                active:
                    True if root.ids.team_name.text else False
            Label:
                text: 'Team Name'
                size_hint_x: .40
            TextInput:
                hint_text: 'ex: KULTURA'
                text: app.team_name
                readonly:
                    False if root.ids.remote_usage.state == 'down' or\
                    root.ids.local_usage.state == 'down' else True
                id: team_name

        # ---------- TMDB API KEY ----------
        BoxLayout:
            padding: '8sp'
            canvas:
                Color:
                    rgba: .2, .3, .4, 1
                Rectangle:
                    size: self.size
                    pos: self.pos
            Switch:
                id: tmdb
                size_hint_x: .20
                touch_control: False
                active:
                    True if root.ids.tmdb_apikey.text else False
            Label:
                text: 'TMDB Api Key'
                size_hint_x: .40
            TextInput:
                hint_text:
                    'Create an account : \
                    https://www.themoviedb.org/account/signup'
                text: app.tmdb_apikey
                readonly:
                    False if root.ids.remote_usage.state == 'down' or\
                    root.ids.local_usage.state == 'down' else True
                id: tmdb_apikey

        # ---------- TRACKER ANNOUNCE ----------
        BoxLayout:
            padding: '8sp'
            canvas:
                Color:
                    rgba: .2, .3, .4, .5
                Rectangle:
                    size: self.size
                    pos: self.pos
            Switch:
                id: tracker
                size_hint_x: .20
                touch_control: False
                active:
                    True if root.ids.tk_announce.text else False
            Label:
                text: 'Tracker Announce'
                size_hint_x: .40
            TextInput:
                hint_text:
                    'ex: https://www.tracker.com:34000/announce'
                text: app.tk_announce
                readonly:
                    False if root.ids.remote_usage.state == 'down' or\
                    root.ids.local_usage.state == 'down' else True
                id: tk_announce

        # ---------- SSH SETTINGS ----------
        BoxLayout:
            padding: '8sp'
            canvas:
                Color:
                    rgba: .2, .3, .4, 1
                Rectangle:
                    size: self.size
                    pos: self.pos
            Switch:
                id: remote
                size_hint_x: .20
                touch_control: False
                active:
                    True if root.ids.ssh_host.text and\
                    root.ids.ssh_port.text and\
                    root.ids.ssh_username.text and\
                    root.ids.ssh_passwd.text else False
            Label:
                text: 'SSH Settings'
                size_hint_x: .40
            BoxLayout:
                TextInput:
                    hint_text: 'Hostname / IP'
                    text: app.ssh_host
                    readonly:
                        False if\
                        root.ids.remote_usage.state == 'down' else True
                    id: ssh_host
                TextInput:
                    size_hint_x: .4
                    hint_text: 'Port'
                    text: app.ssh_port
                    readonly:
                        False if\
                        root.ids.remote_usage.state == 'down' else True
                    id: ssh_port
                TextInput:
                    hint_text: 'Username'
                    text: app.ssh_username
                    readonly:
                        False if\
                        root.ids.remote_usage.state == 'down' else True
                    id: ssh_username
                TextInput:
                    hint_text: 'Password'
                    text: app.ssh_passwd
                    readonly:
                        False if\
                        root.ids.remote_usage.state == 'down' else True
                    id: ssh_passwd

        # ---------- LOCAL MOUNT FOLDER ----------
        BoxLayout:
            padding: '8sp'
            canvas:
                Color:
                    rgba: .2, .3, .4, .5
                Rectangle:
                    size: self.size
                    pos: self.pos
            Switch:
                id: M_folder
                size_hint_x: .20
                touch_control: False
                active:
                    True if root.ids.local_folder.text else False
            Label:
                text: 'Local Folder'
                size_hint_x: .40
            TextInput:
                hint_text: 'ex: /home/user/temp/'
                text: app.local_folder
                readonly:
                    False if\
                    root.ids.remote_usage.state == 'down' else True
                id: local_folder

        # ---------- CONTROL SETTINGS ----------
        BoxLayout:
        BoxLayout:
            Button:
                text: 'Validate Settings'
                on_press:
                    if root.ids.S_folder.active == True and\
                    root.ids.D_folder.active == True:\
                    app.save_settings(
                    root.ids.source_folder.text,
                    root.ids.dest_folder.text,
                    root.ids.team_name.text,
                    root.ids.tmdb_apikey.text,
                    root.ids.tk_announce.text,
                    root.ids.ssh_host.text,
                    root.ids.ssh_port.text,
                    root.ids.ssh_username.text,
                    root.ids.ssh_passwd.text,
                    root.ids.local_folder.text,
                    self.request); app.restart_ankoa()
            Button:
                text: 'Reset Settings'
                on_press: app.reset_settings(); app.restart_ankoa()
            Label:
            Button:
                text: 'Close'
                on_press: root.dismiss()
