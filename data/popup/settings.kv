#:kivy 1.8.0
#:import os os
#:import user app.settings.conf_dict.user

# ---------- SETTINGS POPUP ----------
<SettingsPopup>:
    size_hint: .7, .5
    auto_dismiss: False
    title: 'User settings'
    GridLayout:
        cols: 1
        spacing: 5
        row_force_default: True
        row_default_height: 50

        # ---------- SOURCE FOLDER ----------
        BoxLayout:
            padding: 8
            canvas:
                Color:
                    rgba: 47 / 255., 167 / 255., 212 / 255., .1
                Rectangle:
                    size: self.size
                    pos: self.pos

            # --- Check source ---
            Switch:
                id: S_folder
                size_hint_x: .20
                touch_control: False
                active:
                    True if root.ids.source_folder.text and\
                    os.path.exists(root.ids.source_folder.text) else\
                    False

            # --- Source Label ---
            Label:
                text: 'Source'
                size_hint_x: .40

            # --- Source Input ---
            TextInput:
                hint_text: 'ex: /home/user/SOURCES/'
                text: user['source_folder']
                id: source_folder

        # ---------- DESTINATION FOLDER ----------
        BoxLayout:
            padding: 8
            canvas:
                Color:
                    rgba: 47 / 255., 167 / 255., 212 / 255., .2
                Rectangle:
                    size: self.size
                    pos: self.pos

            # --- Check Destination ---
            Switch:
                id: D_folder
                size_hint_x: .20
                touch_control: False
                active:
                    True if root.ids.dest_folder.text and\
                    os.path.exists(root.ids.dest_folder.text) else\
                    False

            # --- Destination Label ---
            Label:
                text: 'Destination'
                size_hint_x: .40

            # --- Destination Input ---
            TextInput:
                hint_text: 'ex: /home/user/ENCODES/'
                text: user['dest_folder']
                id: dest_folder

        # ---------- TEAM NAME ----------
        BoxLayout:
            padding: 8
            canvas:
                Color:
                    rgba: 47 / 255., 167 / 255., 212 / 255., .1
                Rectangle:
                    size: self.size
                    pos: self.pos

            # --- Check Team Name ---
            Switch:
                id: team
                size_hint_x: .20
                touch_control: False
                active:
                    True if root.ids.team_name.text else False

            # --- Team Name Value ---
            Label:
                text: 'Team Name'
                size_hint_x: .40

            # --- Team Name Input ---
            TextInput:
                hint_text: 'ex: KULTURA'
                text: user['team_name']
                id: team_name

        # ---------- TMDB API KEY ----------
        BoxLayout:
            padding: 8
            canvas:
                Color:
                    rgba: 47 / 255., 167 / 255., 212 / 255., .2
                Rectangle:
                    size: self.size
                    pos: self.pos

            # --- Check TMDB ---
            Switch:
                id: tmdb
                size_hint_x: .20
                touch_control: False
                active:
                    True if root.ids.tmdb_apikey.text else False

            # --- TMDB Label ---
            Label:
                text: 'TMDB Api Key'
                size_hint_x: .40

            # --- TMDB Label ---
            TextInput:
                hint_text:
                    'Create an account : \
                    https://www.themoviedb.org/account/signup'
                text: user['tmdb_apikey']
                id: tmdb_apikey

        # ---------- TRACKER ANNOUNCE ----------
        BoxLayout:
            padding: 8
            canvas:
                Color:
                    rgba: 47 / 255., 167 / 255., 212 / 255., .1
                Rectangle:
                    size: self.size
                    pos: self.pos

            # --- Check Announce ---
            Switch:
                id: tracker
                size_hint_x: .20
                touch_control: False
                active:
                    True if root.ids.tk_announce.text else False

            # --- Announce Label ---
            Label:
                text: 'Tracker Announce'
                size_hint_x: .40

            # --- Announce Input ---
            TextInput:
                hint_text:
                    'ex: https://www.tracker.com:34000/announce'
                text: user['tk_announce']
                id: tk_announce

        # ---------- CONTROL SETTINGS ----------
        BoxLayout:
            padding: 8

            # --- Save ---
            Button:
                id: _valid
                text: 'Save settings'
                on_press:
                    app.save_settings(root) if\
                    root.ids.S_folder.active is True and\
                    root.ids.D_folder.active is True else\
                    app.main_popup('ErrorPopup()')

            # --- Reset ---
            Button:
                text: 'Reset settings'
                on_press:
                    app.reset_settings(root )if\
                    root.ids.S_folder.active is True and\
                    root.ids.D_folder.active is True else\
                    app.main_popup('ErrorPopup()')
            Label:

            # --- Close Settings ---
            Button:
                text: 'Close'
                on_press: root.dismiss()
