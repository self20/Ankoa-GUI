#:kivy 1.8.0
#:import pyramidal_method app.mod_encode.encode_var.pyramidal_method
#:import direct_mode app.mod_encode.encode_var.direct_mode
#:import adaptive_bframes app.mod_encode.encode_var.adaptive_bframes
#:import weighted_pframes app.mod_encode.encode_var.weighted_pframes
#:import motion_method app.mod_encode.encode_var.motion_method
#:import partitions_type app.mod_encode.encode_var.partitions_type
#:import trellis app.mod_encode.encode_var.trellis
#:import quantization app.mod_encode.encode_var.quantization
#:import rate_distortion app.mod_encode.encode_var.rate_distortion
#:import psy_trellis app.mod_encode.encode_var.psy_trellis
#:import deblocking app.mod_encode.encode_var.deblocking

# ---------- ADVANCED SCREEN ----------
<advanced@Widget>:
    pos_hint: {'center_x': .5, 'center_y': .5}
    size_hint: .96, .96
    spacing: 5
    cols: 1

    # ---------- THREADS ----------
    BoxLayout:
        padding: '8sp'
        orientation: 'horizontal'
        size_hint: 1, .1
        canvas:
            Color:
                rgba: .2, .3, .4, .5
            Rectangle:
                size: self.size
                pos: self.pos

        # --- Check Threads ---
        Switch:
            size_hint_x: .12

        # --- Threads Label ---
        Label:
            size_hint_x: .150
            text: 'Threads'
            bold: True

        BoxLayout:

            # --- Threads Number ---
            Label:
                text: 'Threads Number'
            Slider:
                id: threads
                min: 0
                max: 32
                step: 1
                value: 0
            Label:
                text: str(root.ids.threads.value).split('.')[0]
                bold: True

            # --- Slice Threads ---
            ToggleButton:
                text: 'SLICE'
                group: 'threads'

            # --- Frame Threads ---
            ToggleButton:
                text: 'FRAME'
                group: 'threads'

    # ---------- FRAMES ----------
    BoxLayout:
        padding: '8sp'
        orientation: 'horizontal'
        size_hint: 1, .1
        canvas:
            Color:
                rgba: .2, .3, .4, 1
            Rectangle:
                size: self.size
                pos: self.pos

        # --- Check Frames ---
        Switch:
            size_hint_x: .12

        # --- Frames Label ---
        Label:
            size_hint_x: .150
            text: 'Frames'
            bold: True

        BoxLayout:

            # --- REF Frames ---
            Label:
                text: 'Ref-frames'
            Slider:
                id: ref_frames
                min: 0
                max: 16
                step: 1
                value: 0
            Label:
                text: str(root.ids.ref_frames.value).split('.')[0]
                bold: True

            # --- Max BFrames ---
            Label:
                text: 'Max B-Frames  '
            Slider:
                id: b_frames
                min: 0
                max: 16
                step: 1
                value: 0
            Label:
                text: str(root.ids.b_frames.value).split('.')[0]
                bold: True

            # --- Mixed Frames ---
            ToggleButton:
                text: 'MIXED'

    # ---------- ENCODING ----------
    BoxLayout:
        padding: '8sp'
        orientation: 'horizontal'
        size_hint: 1, .1
        canvas:
            Color:
                rgba: .2, .3, .4, .5
            Rectangle:
                size: self.size
                pos: self.pos

        # --- Check Encoding ---
        Switch:
            size_hint_x: .12

        # --- Encoding Label ---
        Label:
            size_hint_x: .150
            text: 'Encoding'
            bold: True

        BoxLayout:

            # --- Pyramidal Method ---
            Label:
                text: 'Pyramidal Method'
            Slider:
                id: pyramidal
                min: 0
                max: 2
                step: 1
                value: 0
            Label:
                text:
                    pyramidal_method[int('{}'.format(pyramidal.value)
                    .split('.')[0])]
                bold: True

            # --- 8x8 Transform ---
            ToggleButton:
                text: '8x8 TRANSFORM'

            # --- Enable Cabac ---
            ToggleButton:
                text: 'CABAC'

    # ---------- ADAPTIVE ----------
    BoxLayout:
        padding: '8sp'
        orientation: 'horizontal'
        size_hint: 1, .1
        canvas:
            Color:
                rgba: .2, .3, .4, 1
            Rectangle:
                size: self.size
                pos: self.pos

        # --- Check Adaptive ---
        Switch:
            size_hint_x: .12

        # --- Adaptive Label ---
        Label:
            size_hint_x: .150
            text: 'Adaptive'
            bold: True

        BoxLayout:

            # --- Direct Mode ---
            Label:
                text: 'Direct Mode  '
            Slider:
                id: direct_mod
                min: 0
                max: 3
                step: 1
                value: 0
            Label:
                text:
                    direct_mode[int('{}'.format(direct_mod.value)
                    .split('.')[0])]
                bold: True

            # --- Adaptive BFrames ---
            Label:
                text: 'B-Frames'
            Slider:
                id: adapt_bf
                min: 0
                max: 2
                step: 1
                value: 0
            Label:
                text:
                    adaptive_bframes[int('{}'.format(adapt_bf.value)
                    .split('.')[0])]
                bold: True

    # ---------- WEIGHTED ----------
    BoxLayout:
        padding: '8sp'
        orientation: 'horizontal'
        size_hint: 1, .1
        canvas:
            Color:
                rgba: .2, .3, .4, .5
            Rectangle:
                size: self.size
                pos: self.pos

        # --- Check Weighted ---
        Switch:
            size_hint_x: .12

        # --- Weighted Label ---
        Label:
            size_hint_x: .150
            text: 'Weighted'
            bold: True

        BoxLayout:

            # --- Weighted BFrames ---
            Label:
                text: 'Weighted B-Frames'
            Slider:
                id: w_pframes
                min: 0
                max: 2
                step: 1
                value: 0
            Label:
                text:
                    weighted_pframes[int('{}'.format(w_pframes.value)
                    .split('.')[0])]
                bold: True

            # --- Weighted PFrames ---
            ToggleButton:
                text: 'Weighted P-Frames'

    # ---------- MOTION ----------
    BoxLayout:
        padding: '8sp'
        orientation: 'horizontal'
        size_hint: 1, .1
        canvas:
            Color:
                rgba: .2, .3, .4, 1
            Rectangle:
                size: self.size
                pos: self.pos

        # --- Check Motion ---
        Switch:
            size_hint_x: .12

        # --- Motion Label ---
        Label:
            size_hint_x: .150
            text: 'Motion'
            bold: True

        BoxLayout:

            # --- Motion Method ---
            Label:
                text: 'Method'
            Slider:
                id: motion_mod
                min: 0
                max: 3
                step: 1
                value: 1
            Label:
                text:
                    motion_method[int('{}'.format(motion_mod.value)
                    .split('.')[0])]
                bold: True

            # --- Subpixel ---
            Label:
                text: 'Subpixel'
            Slider:
                id: subpixel
                min: 0
                max: 11
                step: 1
                value: 7
            Label:
                text: str(subpixel.value).split('.')[0]
                bold: True

            # --- ME Range ---
            Label:
                text: 'ME-Range'
            Slider:
                id: me_range
                min: 4
                max: 64
                step: 1
                value: 16
            Label:
                text: str(me_range.value).split('.')[0]
                bold: True

    # ---------- PARTITIONS ----------
    BoxLayout:
        padding: '8sp'
        orientation: 'horizontal'
        size_hint: 1, .1
        canvas:
            Color:
                rgba: .2, .3, .4, .5
            Rectangle:
                size: self.size
                pos: self.pos

        # --- Check Partitions ---
        Switch:
            size_hint_x: .12

        # --- Partitions Label ---
        Label:
            size_hint_x: .150
            text: 'Partitions'
            bold: True

        BoxLayout:

            # --- Partitions Type ---
            Label:
                text: 'Type'
            Slider:
                id: part_type
                min: 0
                max: 6
                step: 1
                value: 1
            Label:
                text:
                    partitions_type[int('{}'.format(part_type.value)
                    .split('.')[0])]
                bold: True

            # --- Trellis ---
            Label:
                text: 'Trellis'
            Slider:
                id: trelli
                min: 0
                max: 2
                step: 1
                value: 1
            Label:
                text:
                    trellis[int('{}'.format(trelli.value)
                    .split('.')[0])]
                bold: True

    # ---------- QUANTIZATION ----------
    BoxLayout:
        padding: '8sp'
        orientation: 'horizontal'
        size_hint: 1, .1
        canvas:
            Color:
                rgba: .2, .3, .4, 1
            Rectangle:
                size: self.size
                pos: self.pos

        # --- Check Quantization ---
        Switch:
            size_hint_x: .12

        # --- Quantization Label ---
        Label:
            size_hint_x: .150
            text: 'Quantization'
            bold: True

        BoxLayout:

            # --- Adaptive Strenght ---
            Label:
                text: 'Adaptive Strenght'
            Slider:
                id: quantiz
                min: 0
                max: 20
                step: 1
                value: 10
            Label:
                text:
                    quantization[int('{}'.format(quantiz.value)
                    .split('.')[0])]
                bold: True

            # --- Psychovisual Optimization ---
            ToggleButton:
                text: 'PSY OPTIMIZATION'

    # ---------- DISTORTION ----------
    BoxLayout:
        padding: '8sp'
        orientation: 'horizontal'
        size_hint: 1, .1
        canvas:
            Color:
                rgba: .2, .3, .4, .5
            Rectangle:
                size: self.size
                pos: self.pos

        # --- Check Distortion ---
        Switch:
            size_hint_x: .12

        # --- Distortion Label ---
        Label:
            size_hint_x: .150
            text: 'Distortion'
            bold: True

        BoxLayout:

            # --- Rate Distortion ---
            Label:
                text: 'Rate'
            Slider:
                id: rate
                min: 0
                max: 20
                step: 1
                value: 10
            Label:
                text:
                    rate_distortion[int('{}'.format(rate.value)
                    .split('.')[0])]
                bold: True

            # --- Psychovisual Trellis ---
            Label:
                text: 'Pychovisual Trellis   '
            Slider:
                id: psy_trelli
                min: 0
                max: 20
                step: 1
                value: 10
            Label:
                text:
                    psy_trellis[int('{}'.format(psy_trelli.value)
                    .split('.')[0])]
                bold: True

    # ---------- DEBLOCK ----------
    BoxLayout:
        padding: '8sp'
        orientation: 'horizontal'
        size_hint: 1, .1
        canvas:
            Color:
                rgba: .2, .3, .4, 1
            Rectangle:
                size: self.size
                pos: self.pos

        # --- Check Deblock ---
        Switch:
            size_hint_x: .12

        # --- Deblock Label ---
        Label:
            size_hint_x: .150
            text: 'Deblocking'
            bold: True

        BoxLayout:

            # --- Deblock Alpha ---
            Label:
                text: 'Alpha'
            Slider:
                id: alpha
                min: 0
                max: 12
                step: 1
                value: 6
            Label:
                text:
                    deblocking[int('{}'.format(alpha.value)
                    .split('.')[0])]
                bold: True

            # --- Deblock Beta ---
            Label:
                text: 'Beta'
            Slider:
                id: beta
                min: 0
                max: 12
                step: 1
                value: 6
            Label:
                text:
                    deblocking[int('{}'.format(beta.value)
                    .split('.')[0])]
                bold: True

    # ---------- KEYFRAME ----------
    BoxLayout:
        padding: '8sp'
        orientation: 'horizontal'
        size_hint: 1, .1
        canvas:
            Color:
                rgba: .2, .3, .4, .5
            Rectangle:
                size: self.size
                pos: self.pos

        # --- Check Keyframe ---
        Switch:
            size_hint_x: .12

        # --- Keyframe Label ---
        Label:
            size_hint_x: .150
            text: 'KeyFrame'
            bold: True

        BoxLayout:

            # --- Keyframe Interval ---
            Label:
                text: 'Interval'
            TextInput:
                hint_text: '250'
                input_filter: 'int'

            # --- Minimal Key ---
            Label:
                text: 'Minimal Key'
            TextInput:
                hint_text: '25'
                input_filter: 'int'

            # --- RC Lookahead ---
            Label:
                text: 'Lookahead'
            TextInput:
                hint_text: '60'
                input_filter: 'int'

    # ---------- VARIOUS ----------
    BoxLayout:
        padding: '8sp'
        orientation: 'horizontal'
        size_hint: 1, .1
        canvas:
            Color:
                rgba: .2, .3, .4, 1
            Rectangle:
                size: self.size
                pos: self.pos

        # --- Check Various ---
        Switch:
            size_hint_x: .12

        # --- Various Label ---
        Label:
            size_hint_x: .150
            text: 'Various'
            bold: True

        BoxLayout:

            # --- Scenecut ---
            Label:
                text: 'Scenecut'
            TextInput:
                hint_text: '40'
                input_filter: 'int'

            # --- Chroma ---
            ToggleButton:
                text: 'CHROMA'
                input_filter: 'int'

            # --- Fast Skip ---
            ToggleButton:
                text: 'FAST SKIP'
                input_filter: 'int'

            # --- Grayscale ---
            ToggleButton:
                text: 'GRAYSCALE'
                input_filter: 'int'

            # --- BluRay Compatibility ---
            ToggleButton:
                text:
                    'BLURAY'
