#:kivy 1.8.0
#:import user app.settings.conf_dict.user

# ---------- EXTRACT SCREEN ----------
AnkoaScreen:
	name: 'Extract'
    fullscreen: True

    GridLayout:
        rows: 4
        cols: 1
        spacing: 5
        pos_hint: {'center_x': .5, 'center_y': .5}
        size_hint: .97, .96

        # ---------- SOURCE INFOS ----------
        BoxLayout:
            TextInput:
                readonly: True
                padding: 20, 15, 0, 0
                cursor_color: 0, 0, 0, .5
                background_color: 0, 0, 0, .5
                foreground_color: 0, 255, 0, 1
                hint_text: 'Source Infos Area'
                hint_text_color: 0, 255, 0, 1
                text:
                    '' if app.scan_extract is None else\
                    (app.scan_extract).strip()

        # ---------- RELEASE SOURCE ----------
        BoxLayout:
            padding: 8
            spacing: 5
            orientation: 'horizontal'
            size_hint: 1, .1
            canvas:
                Color:
                    rgba: .1, .1, .1, 1
                Rectangle:
                    size: self.size
                    pos: self.pos

            # --- Check Source ---
            Switch:
                id: r_source
                size_hint_x: .14
                touch_control: False
                active:
                    True if root.ids.source.text else False

            # --- Source Label ---
            Label:
                text: 'Video Source'
                size_hint_x: .28
                bold: True

            # --- Select Source ---
            ActionButton:
                size_hint_x: .05
                icon: 'data/icon/add.png'
                popup_id: 'File_managerPopup()'
                on_press:
                    user['request'] = 'extract_source';\
                    app.main_popup(self.popup_id)

            # --- Source Location ---
            TextInput:
                id: source
                multiline: False
                readonly: True
                padding: 8, 8, 0, 0
                text: app.extract_source

        # ---------- VIDEO TRACK ID & TITLE ----------
        BoxLayout:
            padding: 8
            orientation: 'horizontal'
            size_hint: 1, .1
            canvas:
                Color:
                    rgba: .1, .1, .1, 1
                Rectangle:
                    size: self.size
                    pos: self.pos

            # --- Check Track & Title ---
            Switch:
                id: check_vtrack
                size_hint_x: .14
                touch_control: False
                active:
                    True if root.ids.extract_track_ID.text and\
                    root.ids.track_name.text else False

            # --- Track Label ---
            Label:
                text: 'Track to extract'
                bold: True
                size_hint_x: .28

            BoxLayout:

                # --- Track ID ---
                TextInput:
                    id: extract_track_ID
                    hint_text: 'Track ID'
                    multiline: False
                    size_hint_x: .2
                    input_filter: 'int'
                    padding: 8, 8, 0, 0

                # --- Track Name ---
                TextInput:
                    id: track_name
                    hint_text: 'Metadata Title (mediainfo)'
                    multiline: False
                    padding: 8, 8, 0, 0
                    text:
                        (app.extract_source).split('/')[-1][:-4]

        # ---------- EXTRACT MENU ----------
        BoxLayout:
            padding: 8
            orientation: 'horizontal'
            size_hint: 1, .1
            canvas:
                Color:
                    rgba: 2, 2, 2, .5
                Rectangle:
                    size: self.size
                    pos: self.pos

            # --- Extract Button ---
            Button:
                text: 'Add to queue'
                on_press:

            # --- Add Subtitles File Button ---
            Button:
                text: 'Run extraction'
                on_press:
